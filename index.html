<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>Health on FHIR</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800">
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.4.1/css/all.css' integrity='sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz' crossorigin='anonymous'>
    <link rel="stylesheet" href="./css/bootstrap.css">
    <link rel="stylesheet" href="./css/Site.css">
    <script src="./js/jquery.min.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>


    <!-- Google AngularJS -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>

    <!-- Site AngularJS -->
    <script type="text/javascript" src="/js/myAngularApp.js"></script>


</head>

<body ng-app="myApp" ng-controller="loginCtrl" id="pageTop">

    <!-- Top Navigator Bar -->
    <nav class="navbar navbar-expand-md navbar-light navbar-custom py-1" id="navbarTop">

        <!-- Brand Name -->
        <a class="navbar-brand justify-content-center py-1" href="#">
            <span class="fa fa-fire"> Health on FHIR<sup>&reg;</sup></span>
        </a>
        
        <a href="#" class="btn btn-md" ng-click="reLogin()" id="btnReLogin">
            <span class="fas fa-sign-in-alt"></span>
        </a>
        
        <!-- Menu Button -->
<!--         <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMenu" aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button> -->

        <!-- Navbar Menu -->
<!--         <div class="collapse navbar-collapse" id="navbarMenu">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">About</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="btn btn-md" ng-click="reLogin()" id="btnReLogin">
                        <span class="fa fa-sign-in"></span>
                    </a>
                </li>
            </ul>
        </div> -->
    </nav>
      
    <!-- EMR Login -->
    <div class="container-fluid box mx-auto mt-4 mb-5" id="emrLogin">
        <div class="text-center m-auto p-1" style="max-width: 500px; min-width: 300px; background: white">
            <div class="row mx-1 my-auto p-2" id="about" >
                <img src="/assets/fhir.png" width="80" height="45" class="d-inline-block align-text-bottom m-auto" />
                <p>This is a prototype app that uses the SMART<sup>&reg;</sup> on FHIR<sup>&reg;</sup> technology to retrieve patient data from EHR systems.</p>
            </div>
            
            <div class="box mx-1 my-2" id="loginOptions" style="background: whitesmoke">
                <button class="btn-info btn-lg btn-block my-2" ng-click="displaySampleData()">View Sample Data</button>
                <button class="btn-danger btn-lg btn-block my-2" ng-click="testCase('epic')">Epic Sandbox</button>
                <button class="btn-primary btn-lg btn-block my-2" ng-click="testCase('ohmcExt')">Overlake Hospital & Medical Center</button>

                <hr />

                <div class="input-group my-2">
                    <select class="custom-select" id="inputGroupSelectEMR" aria-label="Select EMR" ng-model="fhirEndpointUrl" ng-change="updateSettings()">    
                        <option selected value="0">Choose data source...</option>                       
                        <option ng-repeat="x in fhirOrgs" value="{{x.FHIRPatientFacingURI}}">{{x.OrganizationName}}</option>
                    </select>
                    <div class="input-group-append">
                        <button id="btnLogin" class="btn btn-primary" type="button" ng-click="oauthLogin()" disabled>Login</button>
                    </div>
                </div>          
                <div><input type="checkbox" ng-model="rememberLastLogin" checked value="true"/> Remember my selection</div>

            </div>

            <div id="debugBox" class="box" hidden>
                <div class="">
                    <pre id="txtStatus">{{statusText}}</pre>
                    <dl class="dl-horizontal">
                        <dt>FHIR Base URL</dt>
                        <dd>{{fhirBaseUrl}}</dd>

                        <dt>FHIR Authorize Url</dt>
                        <dd>{{fhirAuthUrl}}</dd>

                        <dt>FHIR Token Url</dt>
                        <dd>{{fhirTokenUrl}}</dd>

                        <dt>FHIR Endpoint Url</dt>
                        <dd>{{fhirEndpointUrl}}</dd>

                        <dt>Client ID</dt>
                        <dd>{{clientId}}</dd>

                        <dt>Authorization Code</dt>
                        <dd>{{oauthCode}}</dd>

                        <dt>Access Token</dt>
                        <dd>{{accessToken}}</dd>

                        <dt>Patient ID</dt>
                        <dd>{{patient}}</dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container text-center px-auto">
            <span>&copy; 2018 Pftech Healthcare Solutions   </span>
            <a href="mailto:pftechsln@gmail.com" id="email">
                <i class="far fa-envelope bold" aria-hidden="true"></i>
            </a>
        </div>
    </footer>

</body>
</html>
